{:highlights [{:id #uuid "645df371-7f1a-475f-b2da-91df3b91831a",
               :page 1,
               :position {:bounding {:x1 0,
                                     :y1 644.2586364746094,
                                     :x2 905.0648498535156,
                                     :y2 1001.2481994628906,
                                     :width 1019.9999999999999,
                                     :height 1319.9999999999998},
                          :rects ({:x1 511.6070861816406,
                                   :y1 644.2586364746094,
                                   :x2 902.2944641113281,
                                   :y2 662.5160217285156,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 664.1849060058594,
                                   :x2 902.8850402832031,
                                   :y2 682.4422912597656,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 684.1111755371094,
                                   :x2 902.3111877441406,
                                   :y2 702.3685607910156,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 704.0373840332031,
                                   :x2 902.0254211425781,
                                   :y2 722.2948303222656,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 716.5180358886719,
                                   :x2 0,
                                   :y2 739.3398132324219,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 723.9636535644531,
                                   :x2 902.2928771972656,
                                   :y2 742.2210998535156,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 732.5218200683594,
                                   :x2 0,
                                   :y2 755.3435974121094,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 743.8899230957031,
                                   :x2 902.0135803222656,
                                   :y2 762.1473693847656,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 748.5256042480469,
                                   :x2 0,
                                   :y2 771.3473815917969,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 763.8161926269531,
                                   :x2 902.3668518066406,
                                   :y2 782.0735778808594,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 764.5293884277344,
                                   :x2 0,
                                   :y2 787.3511657714844,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 780.5331115722656,
                                   :x2 0,
                                   :y2 803.3548889160156,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 783.7281799316406,
                                   :x2 904.3827209472656,
                                   :y2 801.9856262207031,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 796.5368957519531,
                                   :x2 0,
                                   :y2 819.3586730957031,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 803.6544494628906,
                                   :x2 905.0648498535156,
                                   :y2 821.9118347167969,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 812.5406799316406,
                                   :x2 0,
                                   :y2 835.3624572753906,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 823.5807189941406,
                                   :x2 902.3017883300781,
                                   :y2 841.8381042480469,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 828.5444641113281,
                                   :x2 0,
                                   :y2 851.3661804199219,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 511.8780822753906,
                                   :y1 843.5069885253906,
                                   :x2 904.7929992675781,
                                   :y2 861.7643737792969,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 844.5481872558594,
                                   :x2 0,
                                   :y2 867.3699645996094,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 860.5519714355469,
                                   :x2 0,
                                   :y2 883.3737487792969,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 863.4331970214844,
                                   :x2 902.3023986816406,
                                   :y2 881.6906433105469,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 876.5557556152344,
                                   :x2 0,
                                   :y2 899.3775329589844,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 883.3594665527344,
                                   :x2 902.3137512207031,
                                   :y2 901.6169128417969,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 892.5594787597656,
                                   :x2 0,
                                   :y2 915.3812561035156,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 903.2857360839844,
                                   :x2 902.3053283691406,
                                   :y2 921.5431823730469,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 908.5632629394531,
                                   :x2 0,
                                   :y2 931.3850402832031,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 923.2120056152344,
                                   :x2 902.2994689941406,
                                   :y2 941.4693908691406,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 924.5670471191406,
                                   :x2 0,
                                   :y2 947.3888244628906,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 940.5708312988281,
                                   :x2 0,
                                   :y2 963.3926086425781,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 943.1382751464844,
                                   :x2 905.0469055175781,
                                   :y2 961.3956604003906,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 956.5745544433594,
                                   :x2 0,
                                   :y2 979.3963317871094,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 963.0645446777344,
                                   :x2 902.2945861816406,
                                   :y2 981.3219299316406,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 972.5783386230469,
                                   :x2 0,
                                   :y2 995.4001159667969,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 512.3915710449219,
                                   :y1 982.9907531738281,
                                   :x2 554.0028381347656,
                                   :y2 1001.2481994628906,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}),
                          :page 1},
               :content {:text "We discuss briefly what makes generative inference of LLMs challenging. First, large models have a large memory footprint both due to the trained model parameters as well as the transient state needed during decoding. The model parameters generally do not fit in the memory of a single accelerator chip. The attention key and value tensors of each layer, which we refer to as the KV cache, must also be stored in memory for the duration of decoding. Second, tight latency targets become especially challenging for generative inference given the much lower parallelizability of Transformer generation relative to training. The large memory footprint gives rise to a large amount of memory traffic to load the parameters and KV cache from high-bandwidth memory (HBM) into the compute cores for each step, and hence a large total memory bandwidth required to meet a given latency target. Finally, inference cost from the attention mechanism scales quadratically with input sequence length"},
               :properties {:color "yellow"}}
              {:id #uuid "645e02c2-f370-48a6-a586-828528168319",
               :page 4,
               :position {:bounding {:x1 0,
                                     :y1 620.4954681396484,
                                     :x2 624.1326645314693,
                                     :y2 1305.9901733398438,
                                     :width 1313,
                                     :height 1699.1764705882351},
                          :rects ({:x1 0,
                                   :y1 620.4954681396484,
                                   :x2 0,
                                   :y2 643.3172454833984,
                                   :width 1313,
                                   :height 1699.1764705882351}
                                  {:x1 0,
                                   :y1 636.4992370605469,
                                   :x2 0,
                                   :y2 659.3210144042969,
                                   :width 1313,
                                   :height 1699.1764705882351}
                                  {:x1 0,
                                   :y1 652.5030059814453,
                                   :x2 0,
                                   :y2 675.3247833251953,
                                   :width 1313,
                                   :height 1699.1764705882351}
                                  {:x1 231.56967625021935,
                                   :y1 1203.2494506835938,
                                   :x2 623.6385239064693,
                                   :y2 1226.9840698242188,
                                   :width 1313,
                                   :height 1699.1764705882351}
                                  {:x1 118.92995914816856,
                                   :y1 1228.8953857421875,
                                   :x2 624.1326645314693,
                                   :y2 1252.6300048828125,
                                   :width 1313,
                                   :height 1699.1764705882351}
                                  {:x1 118.1739853322506,
                                   :y1 1254.5413818359375,
                                   :x2 622.4183700978756,
                                   :y2 1278.2760009765625,
                                   :width 1313,
                                   :height 1699.1764705882351}
                                  {:x1 118.92995914816856,
                                   :y1 1280.1873168945312,
                                   :x2 195.76800999045372,
                                   :y2 1303.9219360351562,
                                   :width 1313,
                                   :height 1699.1764705882351}
                                  {:x1 234.93588718771935,
                                   :y1 1280.1873168945312,
                                   :x2 437.87814792990685,
                                   :y2 1303.9219360351562,
                                   :width 1313,
                                   :height 1699.1764705882351}
                                  {:x1 196.69514927268028,
                                   :y1 1289.5585327148438,
                                   :x2 234.96075901389122,
                                   :y2 1305.9901733398438,
                                   :width 1313,
                                   :height 1699.1764705882351}),
                          :page 4},
               :content {:text "When a model doesn’t fit on a single chip, the simplest partitioning strategy is 1D weight-stationary, where each E × F weight matrix is partitioned (or sharded) among nchips along the E or F axis. "},
               :properties {:color "yellow"}}
              {:id #uuid "646ab97c-0737-4af7-8986-6428f7b32971",
               :page 4,
               :position {:bounding {:x1 0,
                                     :y1 716.51806640625,
                                     :x2 485.2161560058594,
                                     :y2 1192.5945129394531,
                                     :width 1019.9999999999999,
                                     :height 1319.9999999999998},
                          :rects ({:x1 0,
                                   :y1 716.51806640625,
                                   :x2 0,
                                   :y2 739.33984375,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 732.5218505859375,
                                   :x2 0,
                                   :y2 755.3436279296875,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 748.5256042480469,
                                   :x2 0,
                                   :y2 771.3473815917969,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 764.5293884277344,
                                   :x2 0,
                                   :y2 787.3511657714844,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 780.5331420898438,
                                   :x2 0,
                                   :y2 803.3549194335938,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 0,
                                   :y1 796.5369262695312,
                                   :x2 0,
                                   :y2 819.3586730957031,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 284.9858703613281,
                                   :y1 1054.7937927246094,
                                   :x2 481.4908752441406,
                                   :y2 1073.0512390136719,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 92.399658203125,
                                   :y1 1074.7200622558594,
                                   :x2 482.3135070800781,
                                   :y2 1092.9774475097656,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 92.399658203125,
                                   :y1 1094.6463317871094,
                                   :x2 482.0378112792969,
                                   :y2 1112.9037170410156,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 92.399658203125,
                                   :y1 1114.5726013183594,
                                   :x2 482.3113708496094,
                                   :y2 1132.8299865722656,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 92.399658203125,
                                   :y1 1134.4988098144531,
                                   :x2 482.3030090332031,
                                   :y2 1152.7562561035156,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 92.399658203125,
                                   :y1 1154.4250793457031,
                                   :x2 482.3208312988281,
                                   :y2 1172.6825256347656,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}
                                  {:x1 92.399658203125,
                                   :y1 1174.3370666503906,
                                   :x2 485.2161560058594,
                                   :y2 1192.5945129394531,
                                   :width 1019.9999999999999,
                                   :height 1319.9999999999998}),
                          :page 4},
               :content {:text " Additionally, when computing two consecutive matrix multiplications (as in a Transformer MLP block), there is a “trick” (Shoeybi et al., 2019) to avoid any cross-chip communication between the matmuls: if the first matmul is partitioned by the output axis, the resulting activation shard on each chip will be the exact one needed to compute the second matmul partitioned by the input axis."},
               :properties {:color "yellow"}}
              {:id #uuid "646ae12d-7141-4187-8a7e-bc145e460449",
               :page 4,
               :position {:bounding {:x1 0,
                                     :y1 984.8878479003906,
                                     :x2 1164.7804719805717,
                                     :y2 1363.4867553710938,
                                     :width 1312.9999999999998,
                                     :height 1699.176470588235},
                          :rects ({:x1 809.1898347735405,
                                   :y1 984.8878479003906,
                                   :x2 1164.7804719805717,
                                   :y2 1008.6224670410156,
                                   :width 1312.9999999999998,
                                   :height 1699.176470588235}
                                  {:x1 659.5777131915092,
                                   :y1 1010.5338134765625,
                                   :x2 710.256363093853,
                                   :y2 1034.2684631347656,
                                   :width 1312.9999999999998,
                                   :height 1699.176470588235}
                                  {:x1 753.4180452227592,
                                   :y1 1010.5338134765625,
                                   :x2 1158.8610383868217,
                                   :y2 1034.2684631347656,
                                   :width 1312.9999999999998,
                                   :height 1699.176470588235}
                                  {:x1 711.1977083086967,
                                   :y1 1019.8907470703125,
                                   :x2 753.4327546954155,
                                   :y2 1036.3224182128906,
                                   :width 1312.9999999999998,
                                   :height 1699.176470588235}
                                  {:x1 659.5777131915092,
                                   :y1 1036.1797790527344,
                                   :x2 1161.6295930743217,
                                   :y2 1059.9144287109375,
                                   :width 1312.9999999999998,
                                   :height 1699.176470588235}
                                  {:x1 659.5777131915092,
                                   :y1 1061.8257446289062,
                                   :x2 1161.6189729571342,
                                   :y2 1085.5603942871094,
                                   :width 1312.9999999999998,
                                   :height 1699.176470588235}
                                  {:x1 659.5777131915092,
                                   :y1 1087.4717102050781,
                                   :x2 935.0935823321342,
                                   :y2 1111.2063598632812,
                                   :width 1312.9999999999998,
                                   :height 1699.176470588235}
                                  {:x1 0,
                                   :y1 1292.6536865234375,
                                   :x2 0,
                                   :y2 1315.4754638671875,
                                   :width 1312.9999999999998,
                                   :height 1699.176470588235}
                                  {:x1 0,
                                   :y1 1308.657470703125,
                                   :x2 0,
                                   :y2 1331.479248046875,
                                   :width 1312.9999999999998,
                                   :height 1699.176470588235}
                                  {:x1 0,
                                   :y1 1324.6612548828125,
                                   :x2 0,
                                   :y2 1347.4830322265625,
                                   :width 1312.9999999999998,
                                   :height 1699.176470588235}
                                  {:x1 0,
                                   :y1 1340.6649780273438,
                                   :x2 0,
                                   :y2 1363.4867553710938,
                                   :width 1312.9999999999998,
                                   :height 1699.176470588235}),
                          :page 4},
               :content {:text "For example, if E = 1024, F = 4096, and nchips = 64, then we would shard 4-ways among E and 16-ways among F , so that each of the 64 chips stores a 256-by-256 chunk of the weight matrix, and activations are transferred between chips."},
               :properties {:color "yellow"}}],
 :extra {:page 5}}
